package dev.dgarc.week823challenge;


import java.util.Arrays;

public class ValidateCreditCard {

//            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%,,#@@@@@@@@@#%%#@@@@@@@@@@@@@@@@&&&&@@@@&%%
//            @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/,*&@@@@@%#&#@@@@@@@@@@@@@@@@@@@@&&&%&&@@&
//            @@@@@@@@@@@@@@(@@@@@@@@@@@@@@@@@@@@@@@@%*,#@@&#&#&@@@@@@@@@@@@@@@@@@@@@@@@&&%&%&
//            @@@@@@@@@@@@@@(@@@@@@@@@@@@@@@@@@@@@@@@@@(,*(%%%@@@@&#(#&@@@@@@@@@@@@@@@@@@@&&%%
//            @@@@@#%@@@@@@@(#(%@@@@@@@@@@@@@@@@@@@@@@@@##%/&@@@@@&&%%%%%#((#&@@@@@@@@@@@@@@@&
//            @@@@&#(@@@@@@@##%%%(#@@@@@@@@@@@@@@@@@@@&#&(*,*&#/#%%&&&&&&&#(/#%%%##((%&@@@@@@@
//            @@@&%%(%@@@@@@@(&%%%%%#(#&@@@@@@@@@@@@&#&##@@%,,#@@@@@@@@@@@@@@@&&%%%%%%%%%%(((%
//            @@&&%##(&@@@@@@&#@@@&&%%%%%#(#&@@@@@@#&&#@@@@@@(,*&@@@@@@@@@@@@@@@@@@@@@&&&&%%%%
//            @&%%(#%%(&@@@@@@%%@@@@@@@@@&&%%%#(((#&#&@@@@@@@@&,,#@@@@@@@@@@@@@@@@@@@@@&&&%%##
//            @&%(#%%&@%%@@@@@@%#@@@@@@@@@@@@@@@@@&&&%#((#%&@@@&/,*&&&&&&%##(((##%&&@@@@@@@@@&
//            &&#(%%&@@&%/%%&@@@&#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%@@@@@@@@@@@@@@@@@@@@@@@@@@&
//            &%/%%%%##(%&%#@@@@@&(&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&
//            %#(%(/%@@@@@@@%#@@@@@#%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&
//            %(%(%@@@@@@@@@@&@%#&@@@#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&%##&@@&
//            %/%%@@@@@@@@@@@@@@@@%#&@&#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%(*,,,,,,,*(@@&
//            #(%&@@@@@@@@@@@@@@@@@@@@%##(&@@@@@@@@@@@@@@@@@@@@@@@@@@@&(&&&/*,,,,/#&@@@@@@@@@@
//            #(%&@@@@@@@@@@@@@@@@@@@@@@@@@&@@@@@@@@@@@@@@@@@@@@@@@@%%&%*,,,/%@@@@@@@@@@@@@@@@
//            (#%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&/,*%@@@@@@@@@@@@@@@&&@@@
//            (#%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&@@@@@@@@@@@@&&&&&&&&&&&
//            ((%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&&%&&&&&&
//            @(%&@@@@@@@@@@@@@@@@@&&&@&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&&&&&&&&&
//            @@%#@@@@@@@@@@&%#/*,,,,,,,,,,,/&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&&&&&&@@@
//            @@@@#%@@@@&/,,,,,,,*/#%&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
//            #(((#%(&@@&(/(&&&&&&&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@&&%#(////#&@@@@@@@@@@@@@@@@@@@
//            #%%%%%%##&&@&&%&&&%&&&&&&@@@@@@@@@@@@@@@@@@@&%(/(###########(/&@@@@@@@@@@@@@@@@@
//            (%%%%%%%(%&&&&&&&&&&&&&&&@@@@@@@@@@@@@@%/*/#########%%%%%%%%%(#@@@@@@@@@@@@@@&(
//              (%%%%%%%(%&&&&&&&&&&&&&@@@@@@@@@@@@@@#***(####%%%%%%%%%%%%%%%(@@@@@@@@@@@@%*,.
//               ##%%%%%%(&@@@@@@@@@@@@@@@@@@@@@@@@@@%**(##%%%%%%%%%%%%%%%%%%(@@@@@@@@@&/,,...
//             *  #%&%%%%%(&@@@@@@@@@@@@@@@@@@@@@@@@@@%/%%%%%%%%%%%%%%%%%%%%#&@@@@@@%*,,,,,...
//                 %#&%%%%%(@@@@@@@@@@@@@@@@@@@@@@@@@@@@%#%%%%%%%%%%%%%&%%&&@@@@%/,,,*(/#&&#,/
//               ,  %#@&%%%%##@@@@@@@@@@@@@@@@@@@@@@@@@@@@&%(#%%%%%%%%&&&@@@%(#%%%(//#&&%((%*,
//              .    /#@&%%%%%%#(#&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&%#(#%%%%%%(/%&&&&&/%/,,,


    /**
     * Valid cc: 14 - 19 digits in length, passes luhn test
     *      Luhn test:
     *          1. Remove the last digit (check digit)
     *          2. Reverse the number
     *          3. double the value of each digit in odd-number positions
     *              => if double value becomes double digits, add the digits together (ex. 8 * 2 = 16 -> 1 + 6 = 7)
     *          4. Add all digits
     *          5. subtract the last digit of the sum (from step 4) from 10. [Result should equal the check digit]
     *
     * @param ccNum
     * @return true or false based on validity of passed in credit card number
     */

    public static boolean validateCreditCard(long ccNum){
        char[] charArrayCCNum = Long.toString(ccNum).toCharArray();
        if(charArrayCCNum.length < 14 || charArrayCCNum.length > 19) return false; // Guard for invalid length

        long checkDigit = charArrayCCNum[charArrayCCNum.length - 1];

        char[] removedLastDigitCharArray = Arrays.copyOfRange(charArrayCCNum,0, charArrayCCNum.length -2);

        long sum = 0;
        for(int i = 0; i < removedLastDigitCharArray.length; i++){

            long addable = 0;
            if (i == 1 || i % 3 == 0){
                long doubled = removedLastDigitCharArray[i] * 2L;
                if(doubled > 9L){
                    char[] doubleDigitCharArray = Long.toString(doubled).toCharArray();
                    addable = doubleDigitCharArray[0] + doubleDigitCharArray[1];
                }
            } else{
                addable = removedLastDigitCharArray[i];
            }

            sum += addable;
        }
        long lastSumDigit = Long.toString(sum).toCharArray()[Long.toString(sum).toCharArray().length-1];

        return checkDigit == lastSumDigit;
    }
}
